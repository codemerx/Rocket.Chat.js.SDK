{"version":3,"file":"Livechat.js","sourceRoot":"","sources":["../../../lib/api/Livechat.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @module ApiLivechat\n * Provides a client for making requests with Livechat Rocket.Chat's REST API\n */\n\nimport {\n\tILivechatTokenAPI,\n\tILivechatRoomCredentialAPI,\n\tILivechatRoomSurveyAPI,\n\tINewLivechatGuestAPI,\n\tINewLivechatMessageAPI,\n\tILivechatRoomMessagesAPI,\n\tINewLivechatNavigationAPI,\n\tINewLivechatCustomFieldAPI,\n\tINewLivechatOfflineMessageAPI,\n\tINewLivechatCustomFieldsAPI,\n\tILivechatRoom,\n\tINewLivechatRoomCredentialAPI,\n\tILivechatUploadAPI\n} from '../../interfaces'\n\nimport ApiBase from './api'\n\nexport default class ApiLivechat extends ApiBase {\n  credentials: ILivechatRoomCredentialAPI = {} as any\n  login (guest: INewLivechatGuestAPI | any) { return this.grantVisitor(guest) }\n  async config (params?: ILivechatTokenAPI) { return (await this.get('livechat/config', params, false)).config }\n  async room (params?: INewLivechatRoomCredentialAPI) { return (await this.get('livechat/room', { token: this.credentials.token, ...params }, false)).room }\n  closeChat ({ rid }: ILivechatRoom) { return this.post('livechat/room.close', { rid, token: this.credentials.token }, false) }\n  transferChat ({ rid, department }: ILivechatRoom) { return (this.post('livechat/room.transfer', { rid, token: this.credentials.token, department }, false)) }\n  chatSurvey (survey: ILivechatRoomSurveyAPI) { return (this.post('livechat/room.survey', { rid: survey.rid, token: this.credentials.token, data: survey.data }, false)) }\n  visitor () { return this.get(`livechat/visitor/${this.credentials.token}`) }\n  async grantVisitor (guest: INewLivechatGuestAPI) {\n    const { visitor } = await this.post('livechat/visitor', guest, false)\n    this.credentials = {\n      token: visitor.token\n    }\n    return visitor\n  }\n  async deleteVisitor () { return (await this.del(`livechat/visitor/${this.credentials.token}`)).visitor }\n  async updateVisitorStatus (status: string) { return (await this.post(`livechat/visitor.status`, { token: this.credentials.token, status })).status }\n  async nextAgent (department: string = '') { return (await this.get(`livechat/agent.next/${this.credentials.token}`, { department })).agent }\n  async agent ({ rid }: any) { return (await this.get(`livechat/agent.info/${rid}/${this.credentials.token}`)).agent }\n  async message (id: string, params: ILivechatRoom) { return (await this.get(`livechat/message/${id}`, { token: this.credentials.token, ...params })).message }\n  sendMessage (message: INewLivechatMessageAPI) { return (this.post('livechat/message', { ...message, token: this.credentials.token }, false)) }\n  editMessage (id: string, message: INewLivechatMessageAPI) { return (this.put(`livechat/message/${id}`, message, false)) }\n  deleteMessage (id: string, { rid }: ILivechatRoom) { return (this.del(`livechat/message/${id}`, { rid, token: this.credentials.token }, false)) }\n  async loadMessages (rid: string, params?: ILivechatRoomMessagesAPI) { return (await this.get(`livechat/messages.history/${rid}`, { ...params, token: this.credentials.token }, false)).messages }\n  async sendOfflineMessage (message: INewLivechatOfflineMessageAPI) { return (await this.post('livechat/offline.message', { ...message }, false)).message }\n  sendVisitorNavigation (page: INewLivechatNavigationAPI) { return (this.post('livechat/page.visited', { ...page }, false)) }\n  requestTranscript (email: string, { rid }: ILivechatRoom) { return (this.post('livechat/transcript', { token: this.credentials.token, rid, email }, false)) }\n  videoCall ({ rid }: ILivechatRoom) { return this.get(`livechat/video.call/${this.credentials.token}`, { rid }, false) }\n  sendCustomField (field: INewLivechatCustomFieldAPI) { return this.post('livechat/custom.field', field, false) }\n  sendCustomFields (fields: INewLivechatCustomFieldsAPI) { return this.post('livechat/custom.fields', fields, false) }\n  uploadFile (params: ILivechatUploadAPI) {\n    const formData = new FormData()\n    const headersNeededForUpload = {\n      'x-visitor-token': this.credentials.token\n    }\n    formData.append('file', params.file)\n    return this.post(`livechat/upload/${params.rid}`, formData, false, undefined, { customHeaders: headersNeededForUpload })\n  }\n}\n"]}